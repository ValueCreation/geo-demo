<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="ja">
	<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="width=device-width" />
	<title>Campaign Map</title>
	
	<!-- Stylesheets -->
	<link rel="stylesheet" type="text/css" href="css/index.css" />
	<link rel="stylesheet" type="text/css" href="css/counter.css" />
	<link rel="stylesheet" href="http://js.arcgis.com/3.9/js/dojo/dijit/themes/claro/claro.css">  
	<link rel="stylesheet"type="text/css" href="http://serverapi.arcgisonline.com/jsapi/arcgis/3.5/js/esri/css/esri.css">
	<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css" />
		
	<!-- ArcGIS JavaScript API -->
	<script type="text/javascript" src="http://serverapi.arcgisonline.com/jsapi/arcgis/3.5compact/"></script>
	
	<!-- jQuery -->
	<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
  	<script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
	
	<!-- Supporting Javascript Files -->
	<script type="text/javascript" src="js/config.js"></script>
	<script type="text/javascript" src="js/app.js"></script>
	<script type="text/javascript" src="js/c.js"></script>
	<script type="text/javascript" src="js/tapestry.js"></script>
	
	<script type="text/javascript">
	
		$(function() {
		    
		    $( "#sliderDistanceN" ).slider(
				{
		    		// range: "max",
		    		value: 100,
		    		min: 0,
      				max: 180,
      				step: 10,
					stop: function( event, ui ) {
						natOrgIndex = ui.value;
						if (natOrgIndex == 0) {
							$('#natOrgLabel').text('- -');
						} else {
							$('#natOrgLabel').text(natOrgIndex);
						}
						// natOrgIndexTimer = setTimeout(updateStoresDefQuery, 500);
						updateStoresDefQuery();
					}

		    	}
		    );

		    $( "#sliderFilter" ).slider(
		    	{
		    		range: "min",
		    		min: 0,
      				max: 200,
      				step: 25,
					slide: function( event, ui ) {
						income = ui.value;
						filterTimer = setTimeout(filterStores, 500);
					}
		    	}
		    );
		    
		    $( "#sliderDistance" ).slider(
				{
		    		range: "min",
		    		value: 100,
		    		min: 100,
      				max: 300,
      				step: 50,
					slide: function( event, ui ) {
						distance = ui.value;
						distanceTimer = setTimeout(updateDistance, 500);
					}

		    	}
		    );

		    $('.circle').click(function () {
		    	$(this).toggleClass('circle-selected');
		    	// updateStoresUrbanicity(this.id);
		    	updateStoresDefQuery();
		    });

		    $(".selectText" ).change(function () { 
		    	// console.log($(this).val()) 
		    	updateStoresDefQuery();
		    });

		});
		
	</script>
	
	<script type="text/javascript">
		
		dojo.require("dojo.fx");
		dojo.require("dojo.fx.easing");
		dojo.require("esri.arcgis.utils");
		dojo.require("esri.map");
		dojo.require("esri.tasks.geometry");
		dojo.require("esri.tasks.query");

		dojo.require("dijit.TitlePane");
		dojo.require("esri.dijit.BasemapGallery");
		
	</script>
	
	<style>
	
		/*.esriSimpleSliderTL 
		{
			top: 10px;
			left: 10px;
			border: none;
		}*/
		
		.esriControlsBR 
		{
			position: absolute;
			right: 10px;
			bottom: 15px;
			z-index: 30;
		}
		
		.ui-state-default, .ui-widget-content .ui-state-default, .ui-widget-header .ui-state-default {
			border: none;
			background: url(images/slider_thumb.png) no-repeat;
		}
		
		.slider .ui-state-default:hover {
		    cursor:pointer;
		}
		
		/*.slider, .sliderLabelContainer {
		    margin-left:10px;
		}
		
		.ui-slider-horizontal .ui-slider-handle {
		    top: -6px;
		}*/
		
		.ui-slider-range, .ui-corner-all{
		    height: 8px;
		    -webkit-border-radius: 4px;
		    -moz-border-radius: 4px;
		    border-radius: 4px;
		}
		
		.ui-corner-all{
			border: none;
		    background: url(images/slider_track.png) repeat-x;
		}
		
		.ui-slider-range {
		    border: none;
		    background: url(images/slider_range.png) repeat-x;
		}

		.esriBasemapGallery {
			color: black;
			font-family: HelveticaNeue;
			font-size: 11pt;
		}
		
	</style>
	
	</head>
	<body class="claro">
  		
		<!-- Panel Map -->
		<div id="map"></div>

		<!-- Basemap Gallery -->
		<div style="position:absolute; right:20px; top:10px; z-Index:999;">
          <div data-dojo-type="dijit.TitlePane" 
               data-dojo-props="title:'Switch Basemap', closable:false,  open:false">
            <div data-dojo-type="dijit.layout.ContentPane" style="width:380px; height:280px; overflow:auto;">
            	<div id="basemapGallery" ></div>
            </div>
          </div>
        </div>
		
		<!-- Panel Container -->
		<div id="panelContainer" class="rounded shadow">
			
			<!--Panel Content -->
			<div id="panelContent">
				
				<!-- Panel Campaign -->
				<div id="panelCampaign" class="page">
					<div class="panelHeader">
						CAMPAIGN&nbsp;&nbsp;&nbsp;<input id="txtName" class="inputText" type="text" value="Organic Milk" disabled />
						<a href="javascript:launchCampaign()"><img src="images/go.png" title="Launch Campaign" /></a>
						<!--<a href="javascript:deleteFences()"><img src="images/del.png" title="Delete Campaign" /></a>-->
						<img id="loader" src="images/loader.gif" style="display:none" />
					</div>
					<div class="panelBody">
						<div class="col col1 line">
							<span class="title">STORES</span>
							<div id="panelStores" class="counter"></div>
						</div>
						<div class="col col2 line">
							<span class="title">LIFEMODE GROUP</span>
							<!-- <input id="txtLifeMode" class="inputText" type="select" value="Select Group" /> -->
							<select class="selectText">
								<option value="all">All</option>
								<option value="Traditional Living">Traditional Living</option>
								<option value="Senior Styles">Senior Styles</option>
								<option value="Global Roots">Global Roots</option>
								<option value="Solo Acts">Solo Acts</option>
								<option value="American Quilt">American Quilt</option>
								<option value="Scholars and Patriots">Scholars and Patriots</option>
								<option value="High Society">High Society</option>
								<option value="Family Portrait">Family Portrait</option>
								<option value="Upscale Avenues">Upscale Avenues</option>
								<option value="Factories &amp; Farms">Factories & Farms</option>
								<option value="Metropolis">Metropolis</option>
								<option value="High Hopes">High Hopes</option>
							</select>
							<span class="title">URBANICITY</span>
							<div class="urbanicityContainer">
								<div id="Urban" title="Urban" class="circle"><span class="letter">U</span></div>
								<div id="Suburban" title="Suburban" class="circle"><span class="letter">S</span></div>
								<div id="Rural" title="Rural" class="circle"><span class="letter">R</span></div>
							</div>
						</div>
						<div class="col col3 line">
							<span class="title">NATURAL / ORGANIC INDEX</span>
							<div id="natOrgLabel" class="natOrgCounter">100</div> 					
							<div class="sliderPanelN">
								<div id="sliderDistanceN"></div>
								<div id="labelsDistanceN" class="sliderLabelContainer">
									<span class="sliderLabelN">0</span>
									<span class="sliderLabelN" style="left: 145px">180</span>
								</div>
							</div>
							<!-- <span class="title">FILTER STORES<br/>AVG. HOUSEHOLD INCOME</span><br/> -->
							<!--<input id="chkFilter" type="checkbox" onchange="toggleFilter()"/> Avg. Household Income-->
							<!-- <div class="sliderPanel">
								<div id="sliderFilter"></div>
								<div id="labelsFilter"  class="sliderLabelContainer">
									<span  class="sliderLabel">$0</span>
									<span  class="sliderLabel" style="left: 180px">$200K</span>
								</div>
							</div> -->
						</div>
						<div class="col col4">
							<span class="title">MOBILE MESSAGE</span>
							<input id="txtMessage" class="inputText" type="text" value="$1.50 off Organic Milk" style="font-size:16px;" />
							Distance (meters):
							<div class="sliderPanel">
								<div id="sliderDistance"></div>
								<div id="labelsDistance" class="sliderLabelContainer">
									<span  class="sliderLabel">100</span>
									<span class="sliderLabel" style="left: 180px">300</span>
								</div>
							</div>
						</div>
					</div>
				</div>
				
				
				<!-- Panel Metrics -->
				<div id="panelMetrics" class="page">
					<div class="panelHeader">
						<span>CAMPAIGN METRICS</span>
						<span id="titleSelected">: ALL STORES</span>
					</div>
					<div class="panelBody">
						<div class="col col1-o line">
							<span class="title">COUPONS TRIGGERED</span>
							<div id="panelTriggers" class="counter"></div>
						</div>
						<div class="col col2-o line">
							<span class="title">COUPONS CLAIMED</span>
							<div id="panelSales" class="counter"></div>
						</div>
						<div id="panelSelected2" class="col col3-o">
							<span id="titleStore" class="title">NO STORE SELECTED</span>
							<div id="panelSelected" style="display: none">
								<input id="txtMessageSelected" class="inputText" type="text" /><br/><br/>
								<a href="javascript:updateFence()"><img src="images/save.png" title="Update Message"/></a>
								<a href="javascript:clearSelectedFence()"><img src="images/close.png" title="Close Selected Store"/></a>
							</div>
						</div>
					</div>
					
				</div>
				
				<!-- Panel Analytics -->
				<div id="panelAnalytics" class="page">
					<div class="panelHeader">
						<span>CAMPAIGN ANALYTICS: MOST SUCCESSFUL STORE</span>
					</div>
					<div class="panelBody">
						<div id="panelTapestry1" class="col col1-o line">
						</div>
						<div id="panelTapestry2" class="col col2-o line">
						</div>
						<div id="panelTapestry3" class="col col3-o">
						</div>
					</div>
				</div>
			
			</div>
			
			<div id="panelPrevious" class="panelPrevious" style="display: none" onclick="changePage(-1)"></div>
			<div id="panelNext" class="panelNext"  style="display: none" onclick="changePage(1)"></div>
		</div>
		
	</body>
  
</html>
